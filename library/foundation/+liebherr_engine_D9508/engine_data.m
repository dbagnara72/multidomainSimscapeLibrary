    rpm_nom = [-2100 -2000 -1900 -1800 -1700 -1600 -1500 -1400 -1300 -1200 ...
    -1100 -1000 -900 -800 -700 -600 600 700 800 900 1000 1100 1200 1300 ...
    1400 1500 1600 1700 1800 1900 2000 2100];

    torque_fricion_nom = [160 150 140 130 120 110 100 90 80 70 ...
    60 50 40 30 20 10 -10 -20 -30 -40 -50 -60 -70 ...
    -80 -90 -100 -110 -120 -130 -140 -150 -160];

    torque_nom = [-1952 -2237 -2523 -2641 -2809 -2994 -3002 -2992 -2985 -2981 ...
    -2678 -2306 -2052 -1871 -1593 -1419 1419 1593 1871 2052 2306 2678 2981 ...
    2985 2992 3002 2994 2809 2641 2523 2237 1952];
    
    rpm_consumption = [2100 2000 1900 1800 1700 1600 1500 1400 1300 1200 ...
    1100 1000 900 800 700 600]; % input speed for engine consumption
    
    power_consumption = [3000 2950 2750 2520 2280 2100 1890 1600 1400 1150 ...
    950 680 450 125]; % input power for engine consumption
    
    consumption = [...
        250 240 235 224 222.8 223.9 223.3 225.2 227.8 233.8 241.8 260.2 294.7 380.7; ...
        235	224	222.8 223.9 217.9 217.6 217.8 218.7 220.6 225 232.2 249.3 278.6 350.4; ...
        235 224 222.8 215.9 215.3 214.3 213.8 214.3 215.4 218.8 225 238.2 259.4 335.3; ...
        222.8 223.9 217.9 211.2 210.5 209.5 209 209.8 211 213.8 219 229.5 246.8 327.8; ...
        217.9 211.2	210.5 207.8	206.5 205.7	205.7 205.7	207.4 208.5 214.7 223.7 240.7 305; ...
        208.6 205.9 205.3 203.9 203.1 202.4 202.2 203 204.1 205.2 208.5 217	231.4 283.4; ...
        205.9 202.1	201	199.9 199.6	199.3 199.9	200.5 201.2	204.8 211.5	224	271.9 678.7; ...
        200.2 200.1	199.4 198.7	198.6 197.9	197.7 198.2	199.6 202.8	207.1 218.2	254	603.8; ...
        198.1 198.1 197.7 196.9	197.1 196.9 197.1 197.7 198.8 200.9	205.2 215.5	245.1 574.4; ...
        196.8 196.8 196.8 196 195.4 195.5 196.9	197.7 198.1 199.3 204.1	212.9 239.9 505.4; ...
        210.1 208.6	197.2 196.8 196.3 196.5 196.9 197.3 199 199.8 203.3 209.2 235.5	414.3; ...
        214.6 210.1	208.6 198.9	198.7 199.1	198.6 197.9	199.2 200.2	201.2 206.5	232	340; ...
        223.9 214.6 210.1 208.6 204.8 203.1 202.7 200.8	199.4 200.5 201	205.1 222.9	318; ...
        235	224	222.8 223.9	214.6 210.1	208.6 204.8	202.7 201.3	201.4 206 220.9	298.7; ...
        250	240	235	224	222.8 223.9	214.6 211.8 207.7 203.5	203.8 206.1	220.1 277.3; ...
        300	280	250	240	235	224	222.8 223.9	214.2 208.5 206.5 207.2 222.6 286 ...
        ]; % Engine consumption as function of speed and power
    
    
V = [130 120 110 105 102 101 100.4 100.1]./100*195;
figure;
[M,c] = contour(power_consumption', rpm_consumption, consumption', V...
    ,'ShowText','on');
c.LineWidth = 3;
colormap(gray(256));
grid on
ylabel('$\tau/Nm$','Interpreter','latex')
xlabel('$n/rpm$','Interpreter','latex')
title('\textbf{Liebherr D9508 Engine - Consumption $\mathbf{[g/kWh]}$}','Interpreter','latex')
print -depsc engine_D9508_consumption

figure; 
plot(rpm_nom, torque_nom,'k-','LineWidth',1.8);
hold on
plot(rpm_nom, torque_fricion_nom,'-','LineWidth',1.8,'Color',[0.5 0.5 0.5]);
hold off
legend('$\tau^{nom}$','$\tau^{b}$','Interpreter','latex','Location','best');
set(gca,'xlim',[0 omega(end)/(2*pi/60)]); 
h = get(gca,'Children');
set(gca,'Children',[h(2) h(1)])
ylabel('$\tau_e/Nm$','Interpreter','latex')
xlabel('$n/rpm$','Interpreter','latex')
title('\textbf{Liebherr D9508 Engine - Maximum torque and friction curve}','Interpreter','latex')
grid on
print -depsc engine_D9508_torque

figure; 
plot(rpm_nom, (torque_nom+torque_fricion_nom).*omega*1e-3,'k-','LineWidth',1.8);
legend('$P_e$','Interpreter','latex','Location','best');
set(gca,'xlim',[0 omega(end)/(2*pi/60)]); 
ylabel('$P_e/kW$','Interpreter','latex')
xlabel('$n/rpm$','Interpreter','latex')
title('\textbf{Liebherr D9508 Engine - Maximum power curve}','Interpreter','latex')
grid on
print -depsc engine_D9508_power